{% extends "base.html" %}
{% block title %}Pedido #{{ pedido.id }}{% endblock %}
{% block content %}
<h1>Pedido #{{ pedido.id }}</h1>
<p><strong>Cliente:</strong> {{ pedido.cliente }}</p>
<p><strong>Fecha:</strong> {{ pedido.fecha }}</p>
<p><strong>Estado:</strong> {{ pedido.estado }}</p>

<h3>Items</h3>
<table>
  <thead><tr><th>Producto</th><th>Cantidad</th><th>Precio</th><th>Subtotal</th></tr></thead>
  <tbody>
  {% for it in pedido.items.all %}
    <tr>
      <td>{{ it.producto }}</td>
      <td>{{ it.cantidad }}</td>
      <td>${{ it.precio_unitario }}</td>
      <td>${{ it.subtotal }}</td>
    </tr>
  {% empty %}
    <tr><td colspan="4">Sin items.</td></tr>
  {% endfor %}
  </tbody>
</table>

<p><strong>Total:</strong> ${{ pedido.total }}</p>

{% if pedido.estado == 'nuevo' %}
  <p>
    <a href="{% url 'pedido_procesar' pedido.pk %}">Procesar</a> |
    <a href="{% url 'pedido_cancelar' pedido.pk %}">Cancelar</a>
  </p>
{% elif pedido.estado == 'procesado' %}
  <p><a href="{% url 'pedido_cancelar' pedido.pk %}">Cancelar (repone stock)</a></p>
{% endif %}

<p><a href="{% url 'pedido_list' %}">Volver</a></p>
{% endblock %}
